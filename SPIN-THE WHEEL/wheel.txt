<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spinning Wheel</title>
    <style>
        body {
            font-family: Helvetica Regular;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: none;
            overflow: hidden;
        }

        .card-container {
            display: none; /* Initially hidden */
            background: rgba(255, 255, 255, 0.5); /* Semi-transparent background */
            backdrop-filter: blur(10px); /* Blur effect */
            -webkit-backdrop-filter: blur(10px); /* Safari support */
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3); /* Border to enhance glass effect */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow */
            overflow: hidden;
            margin-left: 10px; /* Adjust margin as needed */
        }

        .card {
            width: 670px;
            height: 650px;
            position: relative;
        }

        .card-content {
            padding: 30px; /* Adjust padding as needed */
            display: flex;
            flex-direction: column;
            align-items: left;
            justify-content: center;
        }

        .card-content h2 {
            color: #333; /* Dark text color */
            font-size: 24px; /* Larger font size */
            margin-bottom: 15px; /* Space below heading */
        }

        .card-content p {
            margin-bottom: 10px;
            font-size: 16px; /* Medium font size */
        }

        #chart {
            width: 50%;
            height: 100%;
        }

        #otp-section {
            display: none;
        }

        .card-content input[type="text"],
        .card-content button {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            box-sizing: border-box; /* Ensure padding is included in width */
            border: 1px solid #f0f0f0; /* Light border */
            border-radius: 5px;
            font-size: 16px; /* Medium font size */
            font-family: 'Cascadia Code', monospace; /* Cascadia Code font */
            color: #333; /* Dark text color */
        }

        .card-content button {
            background-color: #434f66; /* Peach orange background */
            color: #fff; /* White text */
            border: none;
            cursor: pointer;
            font-weight: bold; /* Bold text */
        }

        .card-content button:hover {
            background-color: #323c4d;
        }

        /* Styles for dialog box */
        .dialog-box {
            position: fixed;
            top: 10%;
            left: 80%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body>
<div class="card-container">
    <div class="card">
        <div id="chart"></div>
    </div>
    <div class="card-content">
        <h2>Try your luck !!</h2>
        <input type="text" id="contact-info" placeholder="Mobile number/email">
        <button onclick="sendOTP()">Send OTP</button>
        <div id="otp-section">
            <p>Enter the OTP sent to your mobile number or email ID:</p>
            <input type="text" id="otp" placeholder="OTP">
            <button onclick="verifyOTP()">Verify OTP</button>
        </div>
        <div id="coupon-section" style="display: none;">
            <p>Coupon Code: <span id="coupon-code"></span></p>
        </div>
    </div>
</div>

<div id="dialog" class="dialog-box"></div>

<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script>
    var padding = {top: 20, right: 10, bottom: 0, left: 100},
        w = 600 - padding.left - padding.right,
        h = 600 - padding.top - padding.bottom,
        r = Math.min(w, h) / 2,
        rotation = 0,
        oldrotation = 0,
        picked = 1000,
        oldpick = [],
        color = d3.scale.category20();

    var data = [
        {"label": "₹400 OFF", "value": 1},
        {"label": "₹300 OFF", "value": 2},
        {"label": "₹100 OFF", "value": 3},
        {"label": "JACKPOT!!!", "value": 4},
        {"label": "₹200 OFF", "value": 5},
        {"label": "₹500 OFF", "value": 6}
    ];
    var stoneColor = "#BEB1A1"; // Wood brown color
    var beigeColor = "#8F8F8FS"; // Dark beige color

    var svg = d3.select('#chart')
        .append("svg")
        .data([data])
        .attr("width", w + padding.left + padding.right)
        .attr("height", h + padding.top + padding.bottom);

    var container = svg.append("g")
        .attr("class", "chartholder")
        .attr("transform", "translate(" + (w / 2 + padding.left) + "," + (h / 2 + padding.top) + ")");

    var vis = container.append("g");

    var pie = d3.layout.pie().sort(null).value(function (d) { return 1; });

    var arc = d3.svg.arc().outerRadius(r);

    var arcs = vis.selectAll("g.slice")
        .data(pie(data))
        .enter()
        .append("g")
        .attr("class", "slice");

    arcs.append("path")
        .attr("fill", function (d, i) {
            return i % 2 === 0 ? stoneColor : beigeColor;
        })
        .attr("d", function (d) { return arc(d); });

    arcs.append("text")
        .attr("transform", function(d) {
            d.innerRadius = 0;
            d.outerRadius = r;
            d.angle = (d.startAngle + d.endAngle) / 2;
            return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")translate(" + (d.outerRadius - 20) +")";
        })
        .attr("text-anchor", "end")
        .text(function(d, i) {
            return data[i].label;
        })
        .style("fill", function(d, i) {
            return (i % 2 === 0) ? "#000000" : "#FFFFFF";
        })
        .style({"font-weight": "bold", "font-size": "25px"});

    function sendOTP() {
        var contactInfo = document.getElementById('contact-info').value;
        if (contactInfo) {
            showDialog('OTP has been sent to ' + contactInfo);
            document.getElementById('otp-section').style.display = 'block';
        } else {
            showDialog('Please enter a valid mobile number or email ID.');
        }
    }

    function verifyOTP() {
        var otp = document.getElementById('otp').value;
        if (otp) {
            showDialog('OTP verified successfully!');
            spin();
        } else {
            showDialog('Please enter the OTP.');
        }
    }

    function showDialog(message) {
        var dialog = document.getElementById('dialog');
        dialog.innerText = message;
        dialog.style.display = 'block';
        setTimeout(function() {
            dialog.style.display = 'none';
        }, 3500);
    }

    function spin() {
        if (oldpick.length == data.length) {
            return;
        }

        var ps = 360 / data.length,
            rng = Math.floor((Math.random() * 1440) + 360);

        rotation = (Math.round(rng / ps) * ps);

        picked = Math.round(data.length - (rotation % 360) / ps);
        picked = picked >= data.length ? (picked % data.length) : picked;

        if (oldpick.indexOf(picked) !== -1) {
            spin();
            return;
        } else {
            oldpick.push(picked);
        }

        rotation += 1000 - Math.round(ps / 1.1);
        vis.transition()
            .duration(2900)
            .attrTween("transform", rotTween)
            .each("end", function () {
                var oppositeIndex = (picked + data.length / 2) % data.length;
                var resultMessage;
                switch (data[oppositeIndex].label) {
                    case "₹300 OFF":
                        resultMessage = "DFST300";
                        break;
                    case "₹400 OFF":
                        resultMessage = "DFST400";
                        break;
                    case "₹100 OFF":
                        resultMessage = "DFST100";
                        break;
                    case "₹200 OFF":
                        resultMessage = "DFST200";
                        break;
                    case "₹500 OFF":
                        resultMessage = "DFST500";
                        break;
                    case "JACKPOT!!!":
                        resultMessage = "FREEBIE";
                        break;
                    default:
                        resultMessage = "No prize!";
                        break;
                }
                document.getElementById("coupon-code").innerText = resultMessage;
                document.getElementById("coupon-section").style.display = 'block';
                showDialog("Congratulations, you won!! Use the coupon below to avail the offer: '" + resultMessage + "'");
                oldrotation = rotation;
            });
    }

    svg.append("g")
        .attr("transform", "translate(" + (w + padding.left + padding.right) + "," + ((h / 2) + padding.top) + ")")
        .append("path")
        .attr("d", "M-" + (r * .15) + ",0L0," + (r * .05) + "L0,-" + (r * .05) + "Z")
        .style({"fill": "black"});

    // Show the entire page after 5 seconds
    setTimeout(function() {
        document.querySelector('body').style.display = 'flex';
        document.querySelector('.card-container').style.display = 'flex';
    }, 0000);

    function rotTween(to) {
        var i = d3.interpolate(oldrotation % 360, rotation);
        return function (t) {
            return "rotate(" + i(t) + ")";
        };
    }
</script>
</body>
</html>
